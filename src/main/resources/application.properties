# PromptQuest Application Configuration
# SQLite Database Configuration

# Database connection
spring.datasource.url=jdbc:sqlite:db/promptquest.db
spring.datasource.driver-class-name=org.sqlite.JDBC

# HikariCP Configuration for faster shutdown
spring.datasource.hikari.connection-timeout=5000
spring.datasource.hikari.maximum-pool-size=5
spring.datasource.hikari.minimum-idle=1
spring.datasource.hikari.idle-timeout=30000
spring.datasource.hikari.max-lifetime=120000

# JPA/Hibernate Configuration
# Changed from create-drop to update for startup initialization
# create-drop: Creates tables on startup, drops on shutdown
# update: Creates/updates tables on startup, keeps them on shutdown
# create: Creates tables on startup (drops existing), keeps them on shutdown
spring.jpa.hibernate.ddl-auto=update
spring.jpa.show-sql=true
spring.jpa.properties.hibernate.format_sql=true
spring.jpa.database-platform=org.hibernate.community.dialect.SQLiteDialect
spring.jpa.properties.hibernate.globally_quoted_identifiers=true

# Disable Hibernate's temporary entity tables
spring.jpa.properties.hibernate.hbm2ddl.auto=update
spring.jpa.properties.hibernate.temp.use_jdbc_metadata_defaults=false

# Optimize Hibernate for faster operations and shutdown
spring.jpa.properties.hibernate.jdbc.batch_size=20
spring.jpa.properties.hibernate.order_inserts=true
spring.jpa.properties.hibernate.order_updates=true
spring.jpa.properties.hibernate.jdbc.batch_versioned_data=true

# Application Configuration
server.port=8081
spring.application.name=promptquest

# Graceful Shutdown Configuration - Speed up shutdown process
server.shutdown=graceful
spring.lifecycle.timeout-per-shutdown-phase=10s

# Disable DevTools for faster startup/shutdown (uncomment to disable)
# spring.devtools.add-properties=false
# spring.devtools.livereload.enabled=false

# Logging Configuration
logging.level.com.promptquest=DEBUG
logging.level.org.springframework.web=INFO
logging.level.org.hibernate.SQL=DEBUG
logging.level.org.hibernate.orm.jdbc.bind=TRACE

# JSON Configuration
spring.jackson.property-naming-strategy=SNAKE_CASE
spring.jackson.default-property-inclusion=NON_NULL

# Enable SQL initialization (for future schema.sql usage if needed)
spring.sql.init.mode=never

# File upload configuration (if needed later)
spring.servlet.multipart.max-file-size=10MB
spring.servlet.multipart.max-request-size=10MB

# PromptQuest Database Auto-Initialization Configuration
# Enable/disable automatic database initialization on startup
# Set to false to completely skip JSON import and preserve existing data
promptquest.auto-initialize=false

# JSON file path to load on startup (supports file: and classpath: prefixes)
promptquest.json-file-path=file:input/promptquest-questions-test.json

# Whether to clear existing data before importing
promptquest.clear-on-startup=false